<!DOCTYPE html><html lang="en" class="bg-dark text-white"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"/><title>Store</title><meta http-equiv="X-UA-Compatible" content="ie=edge"/><meta name="keyword" content=" nextjs , react, nextjs, next.js, next js "/><meta name="author" content=""/><meta name="description" content="Excel reading data"/><meta property="og:title" content="Store"/><meta property="og:description" content="Excel reading data"/><meta property="og:image" content="/images/project/05.jpg"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta name="twitter:title" content="Store"/><meta name="twitter:image" content="/images/project/05.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:description" content="Excel reading data"/><link rel="shortcut icon" href="/images/favicon.svg" type="image/x-icon"/><meta name="next-head-count" content="17"/><link rel="preload" href="/_next/static/media/07a54048a9278940-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/4bd742deaa420749-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/css/41a3bd221dd4c081.css" as="style"/><link rel="stylesheet" href="/_next/static/css/41a3bd221dd4c081.css" data-n-g=""/><link rel="preload" href="/_next/static/css/0f519403d706eda6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0f519403d706eda6.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-b8f8d6679aaa5f42.js" defer=""></script><script src="/_next/static/chunks/framework-305cb810cde7afac.js" defer=""></script><script src="/_next/static/chunks/main-b3bd43ad1aa985bd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-ba1ed1fb4b98727b.js" defer=""></script><script src="/_next/static/chunks/675-a58c45fe9fb28c27.js" defer=""></script><script src="/_next/static/chunks/593-34a8a7e326dae523.js" defer=""></script><script src="/_next/static/chunks/81-efbc1fe6eb0ef47b.js" defer=""></script><script src="/_next/static/chunks/pages/project/%5Bslug%5D-2f35b1bb3fc82995.js" defer=""></script><script src="/_next/static/jDtjfixYKLQCXWLwFLPLr/_buildManifest.js" defer=""></script><script src="/_next/static/jDtjfixYKLQCXWLwFLPLr/_ssgManifest.js" defer=""></script></head><body><div id="__next"><section class="__variable_53b90d __variable_817ffb font-primary"><header class="fixed top-0 z-[9000] w-full Header_header__bNjej  "><div class="container"><div class="flex justify-between py-6 items-center relative"><div class="w-1/4 transition-all duration-300 "><a class="inline-block align-middle" href="/"></a></div><nav class="Header_navbar__jBQHm w-12 !h-12 lg:w-auto lg:!h-auto " style="height:auto"><a class="" href="/">Home</a><a class="" href="/about/">About</a><a class="active !text-white/100" href="/project/">Project</a><a class="" href="/blog/">Blog</a><a class="" href="/contact/">Contact</a></nav><div class="Header_navOverlay__NqTwP "></div><button type="button" aria-label="Toggle Mobile Navigation" class="Header_navToggler__qhze5  "><svg class="" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M4 8l16 0"></path><path d="M4 16l16 0"></path></svg><svg class="-rotate-180 translate-x-[3rem]" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M18 6l-12 12"></path><path d="M6 6l12 12"></path></svg></button><div class="w-1/4 transition-all duration-300 text-right text-sm hidden lg:block "><span class="block text-white/75 mb-1">Social Links:</span><ul class="inline-flex gap-x-4"><li class="inline-block hover:opacity-75 transition-op duration-300"><a href="https://www.linkedin.com/in/gabriel-chiorcea/" class="link">LIN</a></li><li class="inline-block hover:opacity-75 transition-op duration-300"><a href="https://github.com/GabrielChiorcea" class="link">GITHUB</a></li></ul></div></div></div></header><main class="bg-dark relative z-10 pt-[92px] lg:pt-[106px] min-h-[82vh] "><section class="pt-2 pb-28"><div class="container"><div class="row justify-center banner"><div class="md:col-7 lg:col-6" data-aos="fade-up-sm"><span class="inline-block text-sm rounded-full bg-[#efefef] px-3 py-1 capitalize text-black mb-6">WebApp</span><div class="flex items-center justify-between gap-4 mb-6"><h1 class="text-4xl md:text-5xl mb-4 !leading-tight">Store</h1><div class="py-3"><a href="https://quote.gabrielchiorcea.tech/" target="_blank"><button class="px-6 py-3 rounded-full text-white bg-black hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-gray-300">Acces live</button></a></div></div><p><em>Excel reading data</em></p><ul class="row text-white mt-4"><li class="col-6 mt-8"><p class="text-white/50 text-xs uppercase tracking-wider mb-2">Client</p><div class="[&amp;_a]:underline [&amp;_a]:hover:no-underline [&amp;_li]:mt-1"><p>World wide</p></div></li><li class="col-6 mt-8"><p class="text-white/50 text-xs uppercase tracking-wider mb-2">Release date</p><div class="[&amp;_a]:underline [&amp;_a]:hover:no-underline [&amp;_li]:mt-1"><p>07-06-2024</p></div></li><li class="col-6 mt-8"><p class="text-white/50 text-xs uppercase tracking-wider mb-2">Tehnology</p><div class="[&amp;_a]:underline [&amp;_a]:hover:no-underline [&amp;_li]:mt-1"><ul>
<li>Python</li>
<li>Rest API</li>
<li>Panda</li>
</ul></div></li><li class="col-6 mt-8"><p class="text-white/50 text-xs uppercase tracking-wider mb-2">Functions</p><div class="[&amp;_a]:underline [&amp;_a]:hover:no-underline [&amp;_li]:mt-1"><ul>
<li>Excel to JSON</li>
<li>User account</li>
<li>Custome API</li>
<li>Chart creation</li>
</ul></div></li></ul></div><div class="md:col-5 lg:col-4 mt-12 md:mt-0" data-aos="fade-up-sm" data-aos-delay="100"><img alt="Store" loading="lazy" width="500" height="500" decoding="async" data-nimg="1" class="aspect-square object-cover object-center rounded-lg bg-light/20 w-full md:w-[500px]" style="color:transparent" src="/images/project/05.jpg"/></div><div class="lg:col-10"><hr class="opacity-5 mt-28 mb-24"/></div></div><div class="row justify-center" data-aos="fade-in"><div class="lg:col-10"><article class="content content-light [&amp;_img]:w-full"><h2>Arhitecture.</h2>
<p>This application serves as a backend capable of processing and reading data from Excel files. To utilize this backend and connect it to a frontend, a user account is required. The account is essential as it provides a unique API key for authentication and authorization.</p>
<p>Excel files are read using Pandas, which converts the file content into a DataFrame. Once transformed into a DataFrame, the data is further converted into JSON format based on the specific functions or filters requested. This enables dynamic and customizable data extraction from the Excel file.</p>
<p>The Excel file itself is stored in the database as a binary large object (BLOB), ensuring secure and efficient storage</p>
<div class="image columns-1 sm:columns-2 gap-8">
<p><img src="/images/project/05-01.jpg" alt="CocaCola 01."/>
<img src="/images/project/05-02.jpg" alt="CocaCola 02."/></p>
</div>
<h2>Get and store the excel file</h2>
<p>The Excel file is uploaded via the /excel endpoint of the API. At this endpoint, the file undergoes validation to ensure it is an Excel file, even if the frontend does not perform this check. Once validated, the file is renamed for consistency and security.</p>
<p>The renaming process involves appending a unique ID, derived from the userâ€™s API key, to the file name. The resulting format is {ID}.xlsx. The renamed file is then securely stored in the database as a BLOB with its new identifier, ensuring traceability and efficient management.</p>
<pre><code class="language-python">@app.route(&#x27;/excel&#x27;, methods=[&#x27;POST&#x27;])
@csrf.exempt
def upload_excel():
    try:
        # Check if a file is present in the request
        if &#x27;file&#x27; not in request.files:
            return jsonify({&#x27;res&#x27;: &#x27;No file found in the request&#x27;}), 400
        
        file_in = request.files[&#x27;file&#x27;]
        id = request.args.get(&#x27;id&#x27;)

        # Validate the user ID parameter
        if not id:
            return jsonify({&#x27;res&#x27;: &#x27;Missing user ID&#x27;}), 400

        # Check if the file name is empty
        if file_in.filename == &#x27;&#x27;:
            return jsonify({&#x27;res&#x27;: &#x27;File name is empty&#x27;}), 400

        # Validate the file extension (only .xlsx and .xls are allowed)
        if not (file_in.filename.endswith(&#x27;.xlsx&#x27;) or file_in.filename.endswith(&#x27;.xls&#x27;)):
            return jsonify({&#x27;res&#x27;: &#x27;Invalid file type, only Excel files are allowed (.xlsx, .xls)&#x27;}), 400

        file_content = file_in.read()
        
        # Ensure the file is not empty
        if not file_content:
            return jsonify({&#x27;res&#x27;: &#x27;Uploaded file is empty&#x27;}), 400

        # Generate a unique name for the file based on the user ID
        file_name = f&quot;{id}.xlsx&quot;

        # Create a new database record for the Excel file
        new_excel_file = Excel(name=file_name, excel=file_content)

        # Add the file to the database session and commit
        db.session.add(new_excel_file)
        db.session.commit()

        return jsonify({&#x27;res&#x27;: &#x27;File uploaded successfully&#x27;}), 200

    except Exception as e:
        # Roll back the database transaction in case of an error
        db.session.rollback()
        print(f&quot;Error: {e}&quot;)  # Log the error details to the console
        return jsonify({&#x27;res&#x27;: f&#x27;An error occurred while processing the file: {str(e)}&#x27;}), 500

</code></pre>
<h2>How the backend know what data to give you</h2>
<p>The below API endpoint, accessible via /<a href="javascript:void(0)">string:para</a>/<a href="javascript:void(0)">string:ident</a> with a GET request, dynamically processes Excel files stored in a database. It retrieves the file based on an id query parameter, reads it into a Pandas DataFrame, and executes specific functions depending on the para value (e.g., counting null values, extracting data, summarizing content, filling missing values, or generating charts). The user&#x27;s existence and identification (ident) are validated against the database, and if necessary, new identification records are created. By utilizing specialized classes (RespondGet and ResponseFill), the endpoint ensures modular and efficient data manipulation while maintaining robust error handling and database consistency.</p>
<pre><code class="language-python">@app.route(&#x27;/&lt;string:para&gt;/&lt;string:ident&gt;&#x27;, methods=[&#x27;GET&#x27;])
@csrf.exempt
def get_with_ident(para, ident):
    identificare = quote(ident)
    id = request.args.get(&#x27;id&#x27;)
    filename = str(id)+&#x27;.xlsx&#x27;
    retrieved_excel_file = Excel.query.filter_by(name=filename).first()
    excel_data = retrieved_excel_file.excel
    excel_df = pd.read_excel(io.BytesIO(excel_data))
    isntance_of_class = RespondGet(excel_df, id)
    isntance_of_fill = ResponseFill(excel_df, id)
    exist = User.query.filter_by(identification=identificare).first()
    identt = Identification.query.filter_by(identification=identificare).first()

    if(exist != None  and identt != None):
            if para == &quot;CountNullValue&quot;:
                count = isntance_of_class.resp_get_null()
                return count
            elif para == &quot;ExtractValue&quot;:
                ex_val = isntance_of_class.resp_get_ex_val()
                return ex_val
            elif para == &quot;ExcelSummary&quot;:
                sumar = isntance_of_class.resp_get_ex_sumar()
                return sumar
            elif para == &#x27;fillNANW0&#x27;:
                fill_na = isntance_of_fill.fill_na()
                return fill_na
            elif para == &#x27;Chart&#x27;:
                chart = isntance_of_class.chart_columns()
                return chart
    elif(exist and identt == None):

        time = datetime.now()
        ident = Identification(timestamp=time, identification= identificare)
        db.session.add(ident)
        db.session.commit()
        if para == &quot;CountNullValue&quot;:
            count = isntance_of_class.resp_get_null()
            return count
        elif para == &quot;ExtractValue&quot;:
            ex_val = isntance_of_class.resp_get_ex_val()
            return ex_val
        elif para == &quot;ExcelSummary&quot;:
            sumar = isntance_of_class.resp_get_ex_sumar()
            return sumar
        elif para == &#x27;fillNANW0&#x27;:
            fill_na = isntance_of_fill.fill_na()
            return fill_na
        elif para == &#x27;Chart&#x27;:
            chart = isntance_of_class.chart_columns()
            return chart
    else:
        return jsonify({&#x27;val&#x27;: exist}), 400
</code></pre></article></div></div></div></section><section class="py-28 bg-white text-dark rounded-b-2xl overflow-hidden"><div class="container"><div class="mb-16"><h2 class="text-4xl md:text-5xl font-secondary font-medium -mt-[6px] text-center">Next Project</h2></div><div class="row justify-center"><div class="lg:col-6"><div data-aos="true" class=" rounded-lg overflow-hidden relative group h-full" style="background-color:#ffffff"><span class="absolute h-full group-[.aos-animate]:h-0 w-full z-30 duration-700 left-0 bottom-0" style="background-color:#307B93;transition-delay:0ms"></span><img alt="Backend" loading="lazy" width="620" height="420" decoding="async" data-nimg="1" class="scale-150 group-[.aos-animate]:scale-100 duration-700 group-hover:!scale-125 object-contain w-full h-full has-twoColumns" style="color:transparent;height:376px" src="/images/project/04.jpg"/><div class="absolute inset-0 z-20 flex justify-center flex-col p-8"><span class="absolute h-full w-full duration-300 left-0 bottom-0 opacity-0 bg-overlay group-hover:opacity-100 -z-10 pointer-events-none"></span><div class="flex items-center justify-between opacity-0 -mt-1 group-hover:opacity-100 group-hover:mt-0 duration-300 group-hover:delay-300"><span class="uppercase text-white bg-white/25 text-sm font-light tracking-wider px-3 py-1 rounded-full backdrop-blur-lg">Art</span><a class="stretched-link" href="/project/backend/"><img alt="arrow" loading="lazy" width="25" height="22" decoding="async" data-nimg="1" class="inline-block rotate-[135deg]" style="color:transparent" src="/images/arrow-right.svg"/></a></div><div class="text-center mt-auto"><h3 class="text-4xl font-secondary font-semibold text-white mb-2 relative overflow-hidden"><span class="block translate-y-full group-hover:translate-y-0 duration-300">Backend</span></h3><p class="text-white font-light relative overflow-hidden"><span class="block translate-y-full group-hover:translate-y-0 duration-300 group-hover:delay-150">Color Splash</span></p></div></div></div></div></div></div></section></main><footer class="pt-28 pb-20 sticky bottom-0 z-[1]"><div class="mb-16 overflow-hidden"><a class="Footer_footer-cta__jiHcZ block text-5xl font-secondary font-medium mb-8" href="/contact/"><div class="Footer_animated-line__iHYSv Footer_animated-line-one__a6fkz mb-5"><div class="Footer_line-block__ri2R2"><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span></div><div class="Footer_line-block-copy__T8Dk5"><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span></div></div><div class="Footer_animated-line__iHYSv Footer_animated-line-two__3ei2E"><div class="Footer_line-block__ri2R2"><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span></div><div class="Footer_line-block-copy__T8Dk5"><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Letâ€™s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span></div></div></a></div><div class="container"><div class="row"><div class="md:col-6 text-center md:text-left mb-4"><ul class="inline-flex flex-wrap justify-center md:justify-start gap-x-6"><li class="inline-block hover:opacity-75 transition-op duration-300"><a href="https://www.linkedin.com/in/gabriel-chiorcea/" class="link">Linkedin</a></li><li class="inline-block hover:opacity-75 transition-op duration-300"><a href="https://github.com/GabrielChiorcea" class="link">Github</a></li></ul></div><div class="md:col-6 text-center md:text-right mb-4"><ul class="inline-flex flex-wrap justify-center md:justify-end gap-x-6"><li class="inline-block hover:opacity-75 transition-op duration-300"><a href="" class="link"></a></li><li class="inline-block hover:opacity-75 transition-op duration-300"><a href="" class="link"></a></li></ul></div><div class="md:col-6 text-center md:text-left mb-4 md:mb-0"><p class="text-white/75"></p></div><div class="md:col-6 text-center md:text-right"></div></div></div></footer></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"currentProject":{"slug":"Store","frontMatter":{"date":"02-05-2023","title":"Store","lang":"Build with Python","description":"Excel reading data","image":"/images/project/05.jpg","color":"#BE0000","category":"WebApp","projectInfo":[{"title":"Client","data":"World wide"},{"title":"Release date","data":"07-06-2024"},{"title":"Tehnology","data":"- Python\n- Rest API\n- Panda\n"},{"title":"Functions","data":"- Excel to JSON \n- User account\n- Custome API\n- Chart creation \n"}],"live":[{"link":"https://quote.gabrielchiorcea.tech/"}]},"content":"\r\n## Arhitecture.\r\n\r\nThis application serves as a backend capable of processing and reading data from Excel files. To utilize this backend and connect it to a frontend, a user account is required. The account is essential as it provides a unique API key for authentication and authorization.\r\n\r\nExcel files are read using Pandas, which converts the file content into a DataFrame. Once transformed into a DataFrame, the data is further converted into JSON format based on the specific functions or filters requested. This enables dynamic and customizable data extraction from the Excel file.\r\n\r\nThe Excel file itself is stored in the database as a binary large object (BLOB), ensuring secure and efficient storage\r\n\r\n\r\n\u003cdiv class=\"image columns-1 sm:columns-2 gap-8\"\u003e\r\n\r\n![CocaCola 01.](/images/project/05-01.jpg)\r\n![CocaCola 02.](/images/project/05-02.jpg)\r\n\u003c/div\u003e\r\n\r\n\r\n## Get and store the excel file\r\n\r\nThe Excel file is uploaded via the /excel endpoint of the API. At this endpoint, the file undergoes validation to ensure it is an Excel file, even if the frontend does not perform this check. Once validated, the file is renamed for consistency and security.\r\n\r\nThe renaming process involves appending a unique ID, derived from the userâ€™s API key, to the file name. The resulting format is {ID}.xlsx. The renamed file is then securely stored in the database as a BLOB with its new identifier, ensuring traceability and efficient management.\r\n\r\n\r\n```python\r\n@app.route('/excel', methods=['POST'])\r\n@csrf.exempt\r\ndef upload_excel():\r\n    try:\r\n        # Check if a file is present in the request\r\n        if 'file' not in request.files:\r\n            return jsonify({'res': 'No file found in the request'}), 400\r\n        \r\n        file_in = request.files['file']\r\n        id = request.args.get('id')\r\n\r\n        # Validate the user ID parameter\r\n        if not id:\r\n            return jsonify({'res': 'Missing user ID'}), 400\r\n\r\n        # Check if the file name is empty\r\n        if file_in.filename == '':\r\n            return jsonify({'res': 'File name is empty'}), 400\r\n\r\n        # Validate the file extension (only .xlsx and .xls are allowed)\r\n        if not (file_in.filename.endswith('.xlsx') or file_in.filename.endswith('.xls')):\r\n            return jsonify({'res': 'Invalid file type, only Excel files are allowed (.xlsx, .xls)'}), 400\r\n\r\n        file_content = file_in.read()\r\n        \r\n        # Ensure the file is not empty\r\n        if not file_content:\r\n            return jsonify({'res': 'Uploaded file is empty'}), 400\r\n\r\n        # Generate a unique name for the file based on the user ID\r\n        file_name = f\"{id}.xlsx\"\r\n\r\n        # Create a new database record for the Excel file\r\n        new_excel_file = Excel(name=file_name, excel=file_content)\r\n\r\n        # Add the file to the database session and commit\r\n        db.session.add(new_excel_file)\r\n        db.session.commit()\r\n\r\n        return jsonify({'res': 'File uploaded successfully'}), 200\r\n\r\n    except Exception as e:\r\n        # Roll back the database transaction in case of an error\r\n        db.session.rollback()\r\n        print(f\"Error: {e}\")  # Log the error details to the console\r\n        return jsonify({'res': f'An error occurred while processing the file: {str(e)}'}), 500\r\n\r\n```\r\n\r\n## How the backend know what data to give you\r\n\r\nThe below API endpoint, accessible via /\u003cstring:para\u003e/\u003cstring:ident\u003e with a GET request, dynamically processes Excel files stored in a database. It retrieves the file based on an id query parameter, reads it into a Pandas DataFrame, and executes specific functions depending on the para value (e.g., counting null values, extracting data, summarizing content, filling missing values, or generating charts). The user's existence and identification (ident) are validated against the database, and if necessary, new identification records are created. By utilizing specialized classes (RespondGet and ResponseFill), the endpoint ensures modular and efficient data manipulation while maintaining robust error handling and database consistency.\r\n\r\n\r\n```python\r\n@app.route('/\u003cstring:para\u003e/\u003cstring:ident\u003e', methods=['GET'])\r\n@csrf.exempt\r\ndef get_with_ident(para, ident):\r\n    identificare = quote(ident)\r\n    id = request.args.get('id')\r\n    filename = str(id)+'.xlsx'\r\n    retrieved_excel_file = Excel.query.filter_by(name=filename).first()\r\n    excel_data = retrieved_excel_file.excel\r\n    excel_df = pd.read_excel(io.BytesIO(excel_data))\r\n    isntance_of_class = RespondGet(excel_df, id)\r\n    isntance_of_fill = ResponseFill(excel_df, id)\r\n    exist = User.query.filter_by(identification=identificare).first()\r\n    identt = Identification.query.filter_by(identification=identificare).first()\r\n\r\n    if(exist != None  and identt != None):\r\n            if para == \"CountNullValue\":\r\n                count = isntance_of_class.resp_get_null()\r\n                return count\r\n            elif para == \"ExtractValue\":\r\n                ex_val = isntance_of_class.resp_get_ex_val()\r\n                return ex_val\r\n            elif para == \"ExcelSummary\":\r\n                sumar = isntance_of_class.resp_get_ex_sumar()\r\n                return sumar\r\n            elif para == 'fillNANW0':\r\n                fill_na = isntance_of_fill.fill_na()\r\n                return fill_na\r\n            elif para == 'Chart':\r\n                chart = isntance_of_class.chart_columns()\r\n                return chart\r\n    elif(exist and identt == None):\r\n\r\n        time = datetime.now()\r\n        ident = Identification(timestamp=time, identification= identificare)\r\n        db.session.add(ident)\r\n        db.session.commit()\r\n        if para == \"CountNullValue\":\r\n            count = isntance_of_class.resp_get_null()\r\n            return count\r\n        elif para == \"ExtractValue\":\r\n            ex_val = isntance_of_class.resp_get_ex_val()\r\n            return ex_val\r\n        elif para == \"ExcelSummary\":\r\n            sumar = isntance_of_class.resp_get_ex_sumar()\r\n            return sumar\r\n        elif para == 'fillNANW0':\r\n            fill_na = isntance_of_fill.fill_na()\r\n            return fill_na\r\n        elif para == 'Chart':\r\n            chart = isntance_of_class.chart_columns()\r\n            return chart\r\n    else:\r\n        return jsonify({'val': exist}), 400\r\n```\r\n\r\n\r\n\r\n"},"nextProject":{"slug":"backend","frontMatter":{"date":"02-05-2023","title":"Backend","lang":"Build with Python","description":"Color Splash","image":"/images/project/04.jpg","color":"#307B93","category":"Art","projectInfo":[{"title":"Client","data":"Backend"},{"title":"Timeline","data":"3 Months"},{"title":"Services","data":"- Branding\n- Website design\n- Marketing and Planning\n"},{"title":"Functions","data":"- Post Like\n- User Account\n- Activity track\n- Share post \n"}],"live":[{"link":"https://quote.gabrielchiorcea.tech/"}]},"content":"\r\n## We couldn't be happier with the branding strategy developed.\r\n\r\nThroughout the process, Aver's collaborative approach and open communication ensured a seamless experience. The outstanding results achieved have elevated our brand and positioned us for long-term success. We couldn't be happier with Aver's work.\r\n\r\n\u003cdiv class=\"image columns-1 sm:columns-2 gap-8\"\u003e\r\n\r\n![Shuvashini 01.](/images/project/04-01.jpg)\r\n![Shuvashini 01.](/images/project/04-02.jpg)\r\n\u003c/div\u003e\r\n\r\n\r\n## Challenge\r\n\r\nChoosing Aver as our branding agency was one of the best decisions we made. Their professionalism, creativity, and dedication made them a true partner in our brand journey. Aver's team took the time to understand our goals and values, crafting a comprehensive brand strategy that perfectly aligned with our vision. They translated this strategy into a visually captivating and impactful visual identity that truly represents our brand essence.\r\n\r\nAver's collaborative approach and open communication ensured a seamless experience. The outstanding results achieved have elevated our brand and positioned us for long-term success. We couldn't be happier with Aver's work.\r\n\r\n\r\n## Solution\r\n\r\nThe client expresses great satisfaction with their decision to choose Aver as their branding agency, describing it as one of the best decisions they made. Aver is commended for their professionalism, creativity, and dedication, which resulted in a strong partnership throughout the client's brand journey. Aver's team took the time to deeply understand the client's goals and values, leading to the development of a comprehensive brand strategy that aligned perfectly with the client's vision. This strategy was then translated into a visually captivating and impactful visual identity that truly represents the essence of the brand.\r\n\r\nThe client appreciates Aver's collaborative approach and open communication, highlighting the seamless experience they had while working together. The outstanding results achieved by Aver have successfully elevated the client's brand and positioned them for long-term success. Overall, the client expresses utmost satisfaction with the work done by Aver.\r\n\r\n\u003cdiv class=\"image columns-1 sm:columns-2 gap-8\"\u003e\r\n\r\n![Shuvashini 01.](/images/project/04-01.jpg)\r\n![Shuvashini 01.](/images/project/04-02.jpg)\r\n\u003c/div\u003e"}},"__N_SSG":true},"page":"/project/[slug]","query":{"slug":"Store"},"buildId":"jDtjfixYKLQCXWLwFLPLr","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>