<!DOCTYPE html><html lang="en" class="bg-dark text-white"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5"/><title>Power</title><meta http-equiv="X-UA-Compatible" content="ie=edge"/><meta name="keyword" content="react, nextjs, next.js, c#, python, javascript, typescript, web development, software development, programming, coding, tech, technology, blog, portfolio, gabriel chiorcea"/><meta name="author" content=""/><meta name="description" content="A frontend that sends an Excel file to a dedicated backend, processes the data, and generates visualizations based on the JSON response returned by the backend."/><meta property="og:title" content="Power"/><meta property="og:description" content="A frontend that sends an Excel file to a dedicated backend, processes the data, and generates visualizations based on the JSON response returned by the backend."/><meta property="og:image" content="/images/project/02.jpg"/><meta property="og:image:width" content="1200"/><meta property="og:image:height" content="630"/><meta name="twitter:title" content="Power"/><meta name="twitter:image" content="/images/project/02.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="twitter:description" content="A frontend that sends an Excel file to a dedicated backend, processes the data, and generates visualizations based on the JSON response returned by the backend."/><link rel="shortcut icon" href="/images/favicon.svg" type="image/x-icon"/><meta name="next-head-count" content="17"/><link rel="preload" href="/_next/static/media/07a54048a9278940-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/media/4bd742deaa420749-s.p.woff2" as="font" type="font/woff2" crossorigin="anonymous" data-next-font="size-adjust"/><link rel="preload" href="/_next/static/css/37385d46332059d1.css" as="style"/><link rel="stylesheet" href="/_next/static/css/37385d46332059d1.css" data-n-g=""/><link rel="preload" href="/_next/static/css/0f519403d706eda6.css" as="style"/><link rel="stylesheet" href="/_next/static/css/0f519403d706eda6.css" data-n-p=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js"></script><script src="/_next/static/chunks/webpack-b8f8d6679aaa5f42.js" defer=""></script><script src="/_next/static/chunks/framework-305cb810cde7afac.js" defer=""></script><script src="/_next/static/chunks/main-b3bd43ad1aa985bd.js" defer=""></script><script src="/_next/static/chunks/pages/_app-97ddcba4b9b4d89b.js" defer=""></script><script src="/_next/static/chunks/675-a58c45fe9fb28c27.js" defer=""></script><script src="/_next/static/chunks/593-34a8a7e326dae523.js" defer=""></script><script src="/_next/static/chunks/81-efbc1fe6eb0ef47b.js" defer=""></script><script src="/_next/static/chunks/pages/project/%5Bslug%5D-20228e2cf7d75172.js" defer=""></script><script src="/_next/static/JQscGFTIUaoxojvdJBQvI/_buildManifest.js" defer=""></script><script src="/_next/static/JQscGFTIUaoxojvdJBQvI/_ssgManifest.js" defer=""></script></head><body><div id="__next"><section class="__variable_53b90d __variable_817ffb font-primary"><header class="fixed top-0 z-[9000] w-full Header_header__bNjej  "><div class="container"><div class="flex justify-between py-6 items-center relative"><div class="w-1/4 transition-all duration-300 "><a class="inline-block align-middle" href="/"></a></div><nav class="Header_navbar__jBQHm w-12 !h-12 lg:w-auto lg:!h-auto " style="height:auto"><a class="" href="/">Home</a><a class="" href="/about/">About</a><a class="active !text-white/100" href="/project/">Project</a><a class="" href="/blog/">Blog</a><a class="" href="/contact/">Contact</a></nav><div class="Header_navOverlay__NqTwP "></div><button type="button" aria-label="Toggle Mobile Navigation" class="Header_navToggler__qhze5  "><svg class="" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M4 8l16 0"></path><path d="M4 16l16 0"></path></svg><svg class="-rotate-180 translate-x-[3rem]" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"></path><path d="M18 6l-12 12"></path><path d="M6 6l12 12"></path></svg></button><div class="w-1/4 transition-all duration-300 text-right text-sm hidden lg:block "><span class="block text-white/75 mb-1">Social Links:</span><ul class="inline-flex gap-x-4"><li class="inline-block hover:opacity-75 transition-op duration-300"><a href="https://www.linkedin.com/in/gabriel-chiorcea/" class="link">LIN</a></li><li class="inline-block hover:opacity-75 transition-op duration-300"><a href="https://github.com/GabrielChiorcea" class="link">GITHUB</a></li></ul></div></div></div></header><main class="bg-dark relative z-10 pt-[92px] lg:pt-[106px] min-h-[82vh] "><section class="pt-2 pb-28"><div class="container"><div class="row justify-center banner"><div class="md:col-7 lg:col-6" data-aos="fade-up-sm"><span class="inline-block text-sm rounded-full bg-[#efefef] px-3 py-1 capitalize text-black mb-6">Frontend</span><div class="flex items-center  gap-4 mb-6"><h1 class="text-4xl md:text-5xl mb-4 !leading-tight">Power</h1><div class="py-3"><a href="https://excelreader.gabrielchiorcea.tech/" target="_blank"><button class="px-6 py-3 rounded-full text-white bg-black hover:bg-gray-800 focus:outline-none focus:ring-2 focus:ring-gray-300">Acces live</button></a></div></div><p><em>A frontend that sends an Excel file to a dedicated backend, processes the data, and generates visualizations based on the JSON response returned by the backend.</em></p><ul class="row text-white mt-4"><li class="col-6 mt-8"><p class="text-white/50 text-xs uppercase tracking-wider mb-2">Client</p><div class="[&amp;_a]:underline [&amp;_a]:hover:no-underline [&amp;_li]:mt-1"><p>World wide</p></div></li><li class="col-6 mt-8"><p class="text-white/50 text-xs uppercase tracking-wider mb-2">Timeline</p><div class="[&amp;_a]:underline [&amp;_a]:hover:no-underline [&amp;_li]:mt-1"><p>10-10-2024</p></div></li><li class="col-6 mt-8"><p class="text-white/50 text-xs uppercase tracking-wider mb-2">Tehnology</p><div class="[&amp;_a]:underline [&amp;_a]:hover:no-underline [&amp;_li]:mt-1"><ul>
<li>React</li>
<li>SASS</li>
<li>Redux</li>
</ul></div></li><li class="col-6 mt-8"><p class="text-white/50 text-xs uppercase tracking-wider mb-2">Functions</p><div class="[&amp;_a]:underline [&amp;_a]:hover:no-underline [&amp;_li]:mt-1"><ul>
<li>Excel file uploading</li>
<li>HTTP requests</li>
<li>Excel data visualization</li>
</ul></div></li></ul></div><div class="md:col-5 lg:col-4 mt-12 md:mt-0" data-aos="fade-up-sm" data-aos-delay="100"><img alt="Power" loading="lazy" width="500" height="500" decoding="async" data-nimg="1" class="aspect-square object-cover object-center rounded-lg bg-light/20 w-full md:w-[500px]" style="color:transparent" src="/images/project/02.jpg"/></div><div class="lg:col-10"><hr class="opacity-5 mt-28 mb-24"/></div></div><div class="row justify-center" data-aos="fade-in"><div class="lg:col-10"><article class="content content-light [&amp;_img]:w-full"><h2>Description.</h2>
<p>This frontend serves two primary and critical functions: processing an Excel file and handling JSON-formatted data received from the backend. The received data is utilized to create a summarized, tabular visualization of the Excel content, ensuring user-friendly data representation. The frontend operates in close connection with the backend project, Store, establishing a seamless backend-frontend integration to deliver an end-to-end solution as a final product.</p>
<p>This project is built using React for the user interface, Sass for styling, and Redux for state management.</p>
<div class="image columns-1 sm:columns-2 gap-8">
<p><img src="/images/project/02-01.jpg" alt="React 01."/>
<img src="/images/project/02-02.jpg" alt="React 02."/>
<img src="/images/project/02-03.jpg" alt="React 01."/>
<img src="/images/project/02-04.jpg" alt="React 02."/></p>
</div>
<h2>Send the Excel</h2>
<p>The ExcelAdIn component in React facilitates Excel file uploads and backend submission. It uses useState for managing file input, validation, and upload readiness, while useDispatch triggers Redux actions. The component validates files against .xlsx or .xls extensions and, upon validation, sends the file to the backend via a POST request at /excel, using FormData. It dynamically renders two views: a file input with a &quot;Validate&quot; button for initial upload and a &quot;Start&quot; button for submission. Modular CSS ensures styling, creating a user-friendly interface for seamless file upload and backend integration.</p>
<pre><code class="language-javascript">const ExcelAdIn = () =&gt; {
  const dispatch = useDispatch();

  const [validate, setValidate] = useState(false);
  const [isExcel, setIsExcel] = useState(false);
  const [excelFile, setExcelFile] = useState(undefined);

  const onSubmit = () =&gt; {
    if (excelFile !== undefined) {
      setIsExcel(true);
    }
  };

  const excelReader = () =&gt; {
    const allowedExtensions = [&#x27;.xlsx&#x27;, &#x27;.xls&#x27;];

    if (excelFile &amp;&amp; allowedExtensions.includes(excelFile.name.slice(-5))) {
      dispatch(excelAction.excelUpLoad(true));
      const formData = new FormData();
      formData.append(&#x27;file&#x27;, excelFile);
      fetch(&#x27;#########&#x27;, {
        method: &#x27;POST&#x27;,
        headers: {
          &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
        },
        body: formData,
      }).then((response) =&gt; console.log(response.json()));
      console.log(formData);
    }
  };

  const start = (
    &lt;div className={style.container}&gt;
      &lt;button className={style.start} onClick={excelReader}&gt;
        Start
      &lt;/button&gt;
    &lt;/div&gt;
  );

  const addExcel = (
    &lt;div className={style.container}&gt;
      {!validate &amp;&amp; (
        &lt;div className={style.addExcel}&gt;
          &lt;label htmlFor=&quot;file-input&quot; className={style.fileLabel}&gt;
            Add Excel
          &lt;/label&gt;
          &lt;input
            type=&quot;file&quot;
            accept=&quot;.xlsx, .xls&quot;
            className={style.fileInput}
            onChange={(e) =&gt; {
              setExcelFile(e.target.files[0]);
              setValidate(true);
            }}
          /&gt;
        &lt;/div&gt;
      )}
      {validate &amp;&amp; (
        &lt;button className={style.start} onClick={onSubmit}&gt;
          Validate
        &lt;/button&gt;
      )}
    &lt;/div&gt;
  );

  return &lt;Fragment&gt;{isExcel ? start : addExcel}&lt;/Fragment&gt;;
};

export default ExcelAdIn;
</code></pre>
<h2>Custom Hook for Dynamic API Requests and Data Handling</h2>
<p>The useQAfetch custom hook is designed to handle API interactions with a backend for various data retrieval or manipulation tasks related to Excel processing. It uses Redux&#x27;s dispatch to update the application state based on the API responses. Here&#x27;s a technical explanation:</p>
<ol>
<li>
<p>Hook Structure: The hook defines an asynchronous function, fetchServer, which accepts a string parameter that determines the API endpoint or function to call.</p>
</li>
<li>
<p>Dynamic Endpoint Selection: Based on the provided string, the function appends it to a base URL to construct the endpoint dynamically. Specific cases, such as &quot;Count null value,&quot; &quot;Excel summary,&quot; and others, are handled with conditional logic.</p>
</li>
<li>
<p>API Call: It uses the fetch API to make HTTP GET requests to the backend. If the string corresponds to an &quot;Under construction&quot; case, it directly dispatches a placeholder response without making a request.</p>
</li>
<li>
<p>Response Parsing:
The response status is validated, and errors are caught and handled gracefully.
For valid responses, the JSON payload is parsed and structured into a standardized format, with fields like rows, columns, and max_value populated for specific strings.</p>
</li>
<li>
<p>Data Dispatch: The parsed data is dispatched to the Redux store using an excelAction.excelResponse action. For &quot;fill NAN W 0,&quot; the response is further processed into an array before dispatching.</p>
</li>
<li>
<p>Error Handling: If the request fails, the error message and response code are logged, and a standardized error response is dispatched to maintain consistency in the application&#x27;s state.</p>
</li>
<li>
<p>Flexibility: By accepting a string parameter, the hook can reuse the same logic for different backend functionalities, reducing code duplication and enhancing maintainability.</p>
</li>
</ol>
<p>This custom hook encapsulates API interaction logic, making it modular and easier to integrate into various components that need backend communication.</p>
<pre><code class="language-javascript">const useQAfetch = () =&gt; {
  const dispatch = useDispatch();

  const fetchServer = async (string) =&gt; {
    const url = &#x27;#########&#x27;;
    let str = string;
    let responseCode;
    let dataRespons;
    let fillNan = [];
    try {
      let response;
      if (str === &#x27;Count null value&#x27;) {
        response = await fetch(url + str);
      } else if (str === &#x27;Excel summary&#x27;) {
        response = await fetch(url + str);
      } else if (str === &#x27;Extract value&#x27;) {
        response = await fetch(url + str);
      } else if (str === &#x27;Chart&#x27;) {
        response = await fetch(url + str);
      } else if (str === &#x27;Under costruction&#x27;) {
        dataRespons = {
          res: &#x27;Under costruction&#x27;,
          question: str,
        };
        console.log(dataRespons);
        dispatch(excelAction.excelResponse(dataRespons));
        return;
      } else if (str === &#x27;fill NAN W 0&#x27;) {
        response = await fetch(url + str);
      } else {
        response = await fetch(url + str);
      }

      responseCode = response.status;

      if (!response.ok) {
        throw new Error(&#x27;Network response was not ok&#x27;);
      }

      const data = await response.json();

      if (str === &#x27;Count null value&#x27;) {
        dataRespons = { res: data.value, question: str };
      } else if (str === &#x27;Excel summary&#x27;) {
        dataRespons = {
          rows: data.rows,
          columns: data.columns,
          col_dtypes: data.col_dtypes,
          max_value: data.max_value,
          min_value: data.min_value,
          question: str,
        };
      } else if (str === &#x27;Extract value&#x27;) {
        dataRespons = {
          value: data.value,
          columns: data.columns,
          row: data.row,
          question: str,
        };
      } else if (&#x27;fill NAN W 0&#x27;) {
        dataRespons = data;
        for (const key in dataRespons) {
          fillNan.push({
            id: dataRespons[key].column,
            question: str,
            column: dataRespons[key].column,
            value: dataRespons[key].arr,
          });
        }
      } else if (str === &#x27;Chart&#x27;) {
        dataRespons = { res: data.value, question: str };
      } else {
        dataRespons = {
          res: data.value,
          question: str,
        };
      }

      if (str === &#x27;fill NAN W 0&#x27;) {
        dispatch(excelAction.excelResponse(fillNan));
      } else {
        dispatch(excelAction.excelResponse(dataRespons));
      }
    } catch (error) {
      console.log(error, responseCode);
      dataRespons = {
        res: `We tryed to call the server but the server code is ${responseCode}`,
        question: &#x27;Error&#x27;,
      };
      dispatch(excelAction.excelResponse(dataRespons));
    }
  };

  return { fetchServer };
};

export default useQAfetch;
</code></pre>
<h2>Chart Configuration and Visualization</h2>
<p>The ChartSettings component is responsible for configuring a chart based on the selected columns from an Excel file, interacting with a backend API. Using useSelector, it extracts data from the application state, including existing responses and current chart configurations. The user can select columns for the X and Y axes, as well as the colors associated with them. These settings are then sent to the backend via a POST request in JSON format. If the request is successful, an image file (the generated chart) is returned, processed, and displayed to the user. The component also includes options to reset the current configuration and displays error messages if the data is invalid or the server request fails. All of these operations are handled using React, with state management via useState and useDispatch, and the interface dynamically updates as the user interacts with the data selection components.</p>
<pre><code class="language-javascript">const ChartSettings = () =&gt; {
  const arr = useSelector((select) =&gt; select.exe.excelResponse);
  const c = useSelector((state) =&gt; state.exe.chart);
  const dispatch = useDispatch();
  const [colXoane, setColXoane] = useState(&#x27;&#x27;);
  const [colXtow, setColXtow] = useState(&#x27;&#x27;);
  const [colY, setColY] = useState(&#x27;&#x27;);
  const [full, setFull] = useState(false);
  const [imageData, setImageData] = useState(null);
  const [s, setS] = useState(false);
  const [err, setErr] = useState(false);

  const [selectedColorXoane, setSelectedColorXoane] = useState(&#x27;Blue&#x27;);
  const [selectedColorXtow, setSelectedColorXtow] = useState(&#x27;Blue&#x27;);

  const handleColorChangeXoane = (event) =&gt; {
    setSelectedColorXoane(event.target.value);
  };
  const handleColorChangeXtow = (event) =&gt; {
    setSelectedColorXtow(event.target.value);
  };

  const setCol = (name) =&gt; {
    if (colXoane === &#x27;&#x27;) {
      setColXoane(name);
    } else if (colXtow === &#x27;&#x27;) {
      setColXtow(name);
      setFull(true);
    } else if (colXoane !== &#x27;&#x27; &amp;&amp; colXtow !== &#x27;&#x27;) {
      return;
    }
  };

  const setY = (name) =&gt; {
    setColY(name);
  };

  const json = {
    columnX1: [colXoane, selectedColorXoane],
    columnX2: [colXtow, selectedColorXtow],
    Y: colY,
  };

  const createChart = async () =&gt; {
    try {
      const response = await fetch(&#x27;#########&#x27;, {
        method: &#x27;POST&#x27;,
        headers: {
          &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,
        },
        body: JSON.stringify(json),
      });

      if (!response.ok) {
        throw new Error(&#x27;Eroare la cerere&#x27;);
      }
      const blob = await response.blob();
      const imageUrl = URL.createObjectURL(blob);
      setImageData(imageUrl);
      dispatch(excelAction.chart(true));
      setS(true);
    } catch (error) {
      console.error(`An error occurred: ${error.message}`);
      setErr(&#x27;This combination does not make sens&#x27;);
    }
    console.log(json);
  };
  const restore = () =&gt; {
    setColXoane(&#x27;&#x27;);
    setColXtow(&#x27;&#x27;);
    setColY(&#x27;&#x27;);
    setFull(false);
    setImageData(null);
    setS(false);
    setSelectedColorXoane(&#x27;Blue&#x27;);
    setSelectedColorXtow(&#x27;Blue&#x27;);
    dispatch(excelAction.chart(false));
    setErr(false);
  };

  const relode = (
    &lt;button className={btn.btn} onClick={restore}&gt;
      relode
    &lt;/button&gt;
  );

  const colNames = arr.res.map((el) =&gt; (
    &lt;ChartBtn key={el} name={el} col={el} onClick={full ? setY : setCol} /&gt;
  ));

  const tablesChios = (
    &lt;&gt;
      &lt;table className={style.tableConatiner}&gt;
        &lt;thead&gt;
          &lt;tr&gt;
            &lt;th className={style.thead}&gt;Axis X&lt;/th&gt;
            &lt;th className={style.thead}&gt;Color for X&lt;/th&gt;
          &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;
          &lt;tr&gt;
            &lt;td
              className={style.tableContent}
              style={{ color: selectedColorXoane, fontWeight: &#x27;bold&#x27; }}
            &gt;
              {colXoane}
            &lt;/td&gt;

            &lt;td className={style.tableContent}&gt;
              &lt;select
                className={style.select}
                value={selectedColorXoane}
                onChange={handleColorChangeXoane}
              &gt;
                &lt;option className={style.option} value=&quot;Blue&quot;&gt;
                  Blue
                &lt;/option&gt;
                &lt;option className={style.option} value=&quot;Red&quot;&gt;
                  Red
                &lt;/option&gt;
                &lt;option className={style.option} value=&quot;Green&quot;&gt;
                  Green
                &lt;/option&gt;
                &lt;option className={style.option} value=&quot;Yellow&quot;&gt;
                  Yellow
                &lt;/option&gt;
              &lt;/select&gt;
            &lt;/td&gt;
          &lt;/tr&gt;
          &lt;tr&gt;
            &lt;td
              className={style.tableContent}
              style={{ color: selectedColorXtow, fontWeight: &#x27;bold&#x27; }}
            &gt;
              {colXtow}
            &lt;/td&gt;

            &lt;td className={style.tableContent}&gt;
              &lt;select
                value={selectedColorXtow}
                onChange={handleColorChangeXtow}
              &gt;
                &lt;option value=&quot;Blue&quot;&gt;Albastru&lt;/option&gt;
                &lt;option value=&quot;Red&quot;&gt;Roșu&lt;/option&gt;
                &lt;option value=&quot;Green&quot;&gt;Verde&lt;/option&gt;
                &lt;option value=&quot;Yellow&quot;&gt;Galben&lt;/option&gt;
              &lt;/select&gt;
            &lt;/td&gt;
          &lt;/tr&gt;
        &lt;/tbody&gt;
      &lt;/table&gt;
      &lt;table className={style.tableConatiner}&gt;
        &lt;thead&gt;
          &lt;tr&gt;
            &lt;th className={style.thead}&gt;Axis Y&lt;/th&gt;
          &lt;/tr&gt;
        &lt;/thead&gt;
        &lt;tbody&gt;
          &lt;tr&gt;
            &lt;td className={style.tableContent} style={{ fontWeight: &#x27;bold&#x27; }}&gt;
              {colY}
            &lt;/td&gt;
          &lt;/tr&gt;
        &lt;/tbody&gt;
      &lt;/table&gt;
    &lt;/&gt;
  );

  const img = (
    &lt;div className={style.imgChart}&gt;
      {imageData &amp;&amp; (
        &lt;img className={style.img} src={imageData} alt=&quot;Descriere imagine&quot; /&gt;
      )}
    &lt;/div&gt;
  );

  const chart = (
    &lt;div className={style.create}&gt;
      &lt;div className={style.chartContainerBtn}&gt;
        &lt;svg
          className={style.svgBtn}
          version=&quot;1.1&quot;
          xmlns=&quot;http://www.w3.org/2000/svg&quot;
          width=&quot;22&quot;
          height=&quot;22&quot;
          viewBox=&quot;0 0 32 32&quot;
        &gt;
          &lt;path d=&quot;M29 0h-26c-1.65 0-3 1.35-3 3v26c0 1.65 1.35 3 3 3h26c1.65 0 3-1.35 3-3v-26c0-1.65-1.35-3-3-3zM14 24c0 1.1-0.9 2-2 2h-4c-1.1 0-2-0.9-2-2v-16c0-1.1 0.9-2 2-2h4c1.1 0 2 0.9 2 2v16zM26 18c0 1.1-0.9 2-2 2h-4c-1.1 0-2-0.9-2-2v-10c0-1.1 0.9-2 2-2h4c1.1 0 2 0.9 2 2v10z&quot;&gt;&lt;/path&gt;
        &lt;/svg&gt;
        &lt;button onClick={createChart} className={style.chartBtnStart}&gt;
          Create
        &lt;/button&gt;
      &lt;/div&gt;
      {err &amp;&amp; (
        &lt;div style={{ display: &#x27;flex&#x27;, flexDirection: &#x27;column&#x27; }}&gt;
          &lt;span style={{ color: &#x27;red&#x27; }}&gt;{err}&lt;/span&gt;
          {relode}
        &lt;/div&gt;
      )}
    &lt;/div&gt;
  );

  return (
    &lt;&gt;
      {!s &amp;&amp; colNames}
      {s &amp;&amp; relode}
      &lt;div className={s ? style.imgContainer : style.chartContainer}&gt;
        {!s &amp;&amp; tablesChios}
        {s ? img : chart}
      &lt;/div&gt;
    &lt;/&gt;
  );
};

export default ChartSettings;
</code></pre>
<h2>Conclusion:</h2>
<p>The front-end implementation demonstrates a well-structured and interactive approach for handling data visualization. It allows users to dynamically select columns for chart creation, customize colors, and submit requests to the backend. The component handles responses efficiently, displaying the generated chart as an image. With a focus on flexibility, it supports multiple combinations of input data and ensures proper error handling to provide a smooth user experience. The inclusion of a reset functionality allows for easy restoration of settings. This front-end approach integrates effectively with the backend, ensuring the process from data selection to chart generation is seamless, intuitive, and user-friendly.</p></article></div></div></div></section><section class="py-28 bg-white text-dark rounded-b-2xl overflow-hidden"><div class="container"><div class="mb-16"><h2 class="text-4xl md:text-5xl font-secondary font-medium -mt-[6px] text-center">Next Project</h2></div><div class="row justify-center"><div class="lg:col-6"><div data-aos="true" class=" rounded-lg overflow-hidden relative group h-full" style="background-color:#ffffff"><span class="absolute h-full group-[.aos-animate]:h-0 w-full z-30 duration-700 left-0 bottom-0" style="background-color:#BE0000;transition-delay:0ms"></span><img alt="Excel Store" loading="lazy" width="620" height="420" decoding="async" data-nimg="1" class="scale-150 group-[.aos-animate]:scale-100 duration-700 group-hover:!scale-125 object-contain w-full h-full has-twoColumns" style="color:transparent;height:376px" src="/images/project/05.jpg"/><div class="absolute inset-0 z-20 flex justify-center flex-col p-8"><span class="absolute h-full w-full duration-300 left-0 bottom-0 opacity-0 bg-overlay group-hover:opacity-100 -z-10 pointer-events-none"></span><div class="flex items-center justify-between opacity-0 -mt-1 group-hover:opacity-100 group-hover:mt-0 duration-300 group-hover:delay-300"><span class="uppercase text-white bg-white/25 text-sm font-light tracking-wider px-3 py-1 rounded-full backdrop-blur-lg">Backend</span><a class="stretched-link" href="/project/store/"><img alt="arrow" loading="lazy" width="25" height="22" decoding="async" data-nimg="1" class="inline-block rotate-[135deg]" style="color:transparent" src="/images/arrow-right.svg"/></a></div><div class="text-center mt-auto"><h3 class="text-4xl font-secondary font-semibold text-white mb-2 relative overflow-hidden"><span class="block translate-y-full group-hover:translate-y-0 duration-300">Excel Store</span></h3><p class="text-white font-light relative overflow-hidden"><span class="block translate-y-full group-hover:translate-y-0 duration-300 group-hover:delay-150">Backend with user creation and authentication, excel reading data and transfer in in JSON as response</span></p></div></div></div></div></div></div></section></main><footer class="pt-28 pb-20 sticky bottom-0 z-[1]"><div class="mb-16 overflow-hidden"><a class="Footer_footer-cta__jiHcZ block text-5xl font-secondary font-medium mb-8" href="/contact/"><div class="Footer_animated-line__iHYSv Footer_animated-line-one__a6fkz mb-5"><div class="Footer_line-block__ri2R2"><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span></div><div class="Footer_line-block-copy__T8Dk5"><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span></div></div><div class="Footer_animated-line__iHYSv Footer_animated-line-two__3ei2E"><div class="Footer_line-block__ri2R2"><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span></div><div class="Footer_line-block-copy__T8Dk5"><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span><span class="mr-24"><span class="Footer_cta-text__4dzFD">Let’s get in touch</span><img alt="arrow-right" loading="lazy" width="39" height="31" decoding="async" data-nimg="1" class="inline-block ml-16 Footer_cta-icon__a3mwY" style="color:transparent" src="/images/arrow-right.svg"/></span></div></div></a></div><div class="container"><div class="row"><div class="md:col-6 text-center md:text-left mb-4"><ul class="inline-flex flex-wrap justify-center md:justify-start gap-x-6"><li class="inline-block hover:opacity-75 transition-op duration-300"><a href="https://www.linkedin.com/in/gabriel-chiorcea/" class="link">Linkedin</a></li><li class="inline-block hover:opacity-75 transition-op duration-300"><a href="https://github.com/GabrielChiorcea" class="link">Github</a></li></ul></div><div class="md:col-6 text-center md:text-right mb-4"><ul class="inline-flex flex-wrap justify-center md:justify-end gap-x-6"><li class="inline-block hover:opacity-75 transition-op duration-300"><a href="" class="link"></a></li><li class="inline-block hover:opacity-75 transition-op duration-300"><a href="" class="link"></a></li></ul></div><div class="md:col-6 text-center md:text-left mb-4 md:mb-0"><p class="text-white/75"></p></div><div class="md:col-6 text-center md:text-right"></div></div></div></footer></section></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"currentProject":{"slug":"power","frontMatter":{"date":"2016-10-10","title":"Power","lang":"Build with React","description":"A frontend that sends an Excel file to a dedicated backend, processes the data, and generates visualizations based on the JSON response returned by the backend.","image":"/images/project/02.jpg","color":"#BE0000","category":"Frontend","projectInfo":[{"title":"Client","data":"World wide"},{"title":"Timeline","data":"10-10-2024"},{"title":"Tehnology","data":"- React\n- SASS\n- Redux\n"},{"title":"Functions","data":"- Excel file uploading\n- HTTP requests\n- Excel data visualization\n \n"}],"live":[{"link":"https://excelreader.gabrielchiorcea.tech/"}]},"content":"\r\n## Description.\r\n\r\nThis frontend serves two primary and critical functions: processing an Excel file and handling JSON-formatted data received from the backend. The received data is utilized to create a summarized, tabular visualization of the Excel content, ensuring user-friendly data representation. The frontend operates in close connection with the backend project, Store, establishing a seamless backend-frontend integration to deliver an end-to-end solution as a final product.\r\n\r\nThis project is built using React for the user interface, Sass for styling, and Redux for state management.\r\n\r\n\u003cdiv className=\"image columns-1 sm:columns-2 gap-8\"\u003e\r\n\r\n![React 01.](/images/project/02-01.jpg)\r\n![React 02.](/images/project/02-02.jpg)\r\n![React 01.](/images/project/02-03.jpg)\r\n![React 02.](/images/project/02-04.jpg)\r\n\u003c/div\u003e\r\n\r\n\r\n## Send the Excel\r\n\r\nThe ExcelAdIn component in React facilitates Excel file uploads and backend submission. It uses useState for managing file input, validation, and upload readiness, while useDispatch triggers Redux actions. The component validates files against .xlsx or .xls extensions and, upon validation, sends the file to the backend via a POST request at /excel, using FormData. It dynamically renders two views: a file input with a \"Validate\" button for initial upload and a \"Start\" button for submission. Modular CSS ensures styling, creating a user-friendly interface for seamless file upload and backend integration.\r\n\r\n```javascript\r\nconst ExcelAdIn = () =\u003e {\r\n  const dispatch = useDispatch();\r\n\r\n  const [validate, setValidate] = useState(false);\r\n  const [isExcel, setIsExcel] = useState(false);\r\n  const [excelFile, setExcelFile] = useState(undefined);\r\n\r\n  const onSubmit = () =\u003e {\r\n    if (excelFile !== undefined) {\r\n      setIsExcel(true);\r\n    }\r\n  };\r\n\r\n  const excelReader = () =\u003e {\r\n    const allowedExtensions = ['.xlsx', '.xls'];\r\n\r\n    if (excelFile \u0026\u0026 allowedExtensions.includes(excelFile.name.slice(-5))) {\r\n      dispatch(excelAction.excelUpLoad(true));\r\n      const formData = new FormData();\r\n      formData.append('file', excelFile);\r\n      fetch('#########', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: formData,\r\n      }).then((response) =\u003e console.log(response.json()));\r\n      console.log(formData);\r\n    }\r\n  };\r\n\r\n  const start = (\r\n    \u003cdiv className={style.container}\u003e\r\n      \u003cbutton className={style.start} onClick={excelReader}\u003e\r\n        Start\r\n      \u003c/button\u003e\r\n    \u003c/div\u003e\r\n  );\r\n\r\n  const addExcel = (\r\n    \u003cdiv className={style.container}\u003e\r\n      {!validate \u0026\u0026 (\r\n        \u003cdiv className={style.addExcel}\u003e\r\n          \u003clabel htmlFor=\"file-input\" className={style.fileLabel}\u003e\r\n            Add Excel\r\n          \u003c/label\u003e\r\n          \u003cinput\r\n            type=\"file\"\r\n            accept=\".xlsx, .xls\"\r\n            className={style.fileInput}\r\n            onChange={(e) =\u003e {\r\n              setExcelFile(e.target.files[0]);\r\n              setValidate(true);\r\n            }}\r\n          /\u003e\r\n        \u003c/div\u003e\r\n      )}\r\n      {validate \u0026\u0026 (\r\n        \u003cbutton className={style.start} onClick={onSubmit}\u003e\r\n          Validate\r\n        \u003c/button\u003e\r\n      )}\r\n    \u003c/div\u003e\r\n  );\r\n\r\n  return \u003cFragment\u003e{isExcel ? start : addExcel}\u003c/Fragment\u003e;\r\n};\r\n\r\nexport default ExcelAdIn;\r\n```\r\n\r\n\r\n\r\n## Custom Hook for Dynamic API Requests and Data Handling\r\n\r\nThe useQAfetch custom hook is designed to handle API interactions with a backend for various data retrieval or manipulation tasks related to Excel processing. It uses Redux's dispatch to update the application state based on the API responses. Here's a technical explanation:\r\n\r\n1. Hook Structure: The hook defines an asynchronous function, fetchServer, which accepts a string parameter that determines the API endpoint or function to call.\r\n\r\n2. Dynamic Endpoint Selection: Based on the provided string, the function appends it to a base URL to construct the endpoint dynamically. Specific cases, such as \"Count null value,\" \"Excel summary,\" and others, are handled with conditional logic.\r\n\r\n3. API Call: It uses the fetch API to make HTTP GET requests to the backend. If the string corresponds to an \"Under construction\" case, it directly dispatches a placeholder response without making a request.\r\n\r\n4. Response Parsing:\r\nThe response status is validated, and errors are caught and handled gracefully.\r\nFor valid responses, the JSON payload is parsed and structured into a standardized format, with fields like rows, columns, and max_value populated for specific strings.\r\n\r\n5. Data Dispatch: The parsed data is dispatched to the Redux store using an excelAction.excelResponse action. For \"fill NAN W 0,\" the response is further processed into an array before dispatching.\r\n\r\n6. Error Handling: If the request fails, the error message and response code are logged, and a standardized error response is dispatched to maintain consistency in the application's state.\r\n\r\n7. Flexibility: By accepting a string parameter, the hook can reuse the same logic for different backend functionalities, reducing code duplication and enhancing maintainability.\r\n\r\nThis custom hook encapsulates API interaction logic, making it modular and easier to integrate into various components that need backend communication.\r\n\r\n```javascript\r\nconst useQAfetch = () =\u003e {\r\n  const dispatch = useDispatch();\r\n\r\n  const fetchServer = async (string) =\u003e {\r\n    const url = '#########';\r\n    let str = string;\r\n    let responseCode;\r\n    let dataRespons;\r\n    let fillNan = [];\r\n    try {\r\n      let response;\r\n      if (str === 'Count null value') {\r\n        response = await fetch(url + str);\r\n      } else if (str === 'Excel summary') {\r\n        response = await fetch(url + str);\r\n      } else if (str === 'Extract value') {\r\n        response = await fetch(url + str);\r\n      } else if (str === 'Chart') {\r\n        response = await fetch(url + str);\r\n      } else if (str === 'Under costruction') {\r\n        dataRespons = {\r\n          res: 'Under costruction',\r\n          question: str,\r\n        };\r\n        console.log(dataRespons);\r\n        dispatch(excelAction.excelResponse(dataRespons));\r\n        return;\r\n      } else if (str === 'fill NAN W 0') {\r\n        response = await fetch(url + str);\r\n      } else {\r\n        response = await fetch(url + str);\r\n      }\r\n\r\n      responseCode = response.status;\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Network response was not ok');\r\n      }\r\n\r\n      const data = await response.json();\r\n\r\n      if (str === 'Count null value') {\r\n        dataRespons = { res: data.value, question: str };\r\n      } else if (str === 'Excel summary') {\r\n        dataRespons = {\r\n          rows: data.rows,\r\n          columns: data.columns,\r\n          col_dtypes: data.col_dtypes,\r\n          max_value: data.max_value,\r\n          min_value: data.min_value,\r\n          question: str,\r\n        };\r\n      } else if (str === 'Extract value') {\r\n        dataRespons = {\r\n          value: data.value,\r\n          columns: data.columns,\r\n          row: data.row,\r\n          question: str,\r\n        };\r\n      } else if ('fill NAN W 0') {\r\n        dataRespons = data;\r\n        for (const key in dataRespons) {\r\n          fillNan.push({\r\n            id: dataRespons[key].column,\r\n            question: str,\r\n            column: dataRespons[key].column,\r\n            value: dataRespons[key].arr,\r\n          });\r\n        }\r\n      } else if (str === 'Chart') {\r\n        dataRespons = { res: data.value, question: str };\r\n      } else {\r\n        dataRespons = {\r\n          res: data.value,\r\n          question: str,\r\n        };\r\n      }\r\n\r\n      if (str === 'fill NAN W 0') {\r\n        dispatch(excelAction.excelResponse(fillNan));\r\n      } else {\r\n        dispatch(excelAction.excelResponse(dataRespons));\r\n      }\r\n    } catch (error) {\r\n      console.log(error, responseCode);\r\n      dataRespons = {\r\n        res: `We tryed to call the server but the server code is ${responseCode}`,\r\n        question: 'Error',\r\n      };\r\n      dispatch(excelAction.excelResponse(dataRespons));\r\n    }\r\n  };\r\n\r\n  return { fetchServer };\r\n};\r\n\r\nexport default useQAfetch;\r\n```\r\n\r\n## Chart Configuration and Visualization\r\n\r\nThe ChartSettings component is responsible for configuring a chart based on the selected columns from an Excel file, interacting with a backend API. Using useSelector, it extracts data from the application state, including existing responses and current chart configurations. The user can select columns for the X and Y axes, as well as the colors associated with them. These settings are then sent to the backend via a POST request in JSON format. If the request is successful, an image file (the generated chart) is returned, processed, and displayed to the user. The component also includes options to reset the current configuration and displays error messages if the data is invalid or the server request fails. All of these operations are handled using React, with state management via useState and useDispatch, and the interface dynamically updates as the user interacts with the data selection components.\r\n\r\n\r\n```javascript\r\nconst ChartSettings = () =\u003e {\r\n  const arr = useSelector((select) =\u003e select.exe.excelResponse);\r\n  const c = useSelector((state) =\u003e state.exe.chart);\r\n  const dispatch = useDispatch();\r\n  const [colXoane, setColXoane] = useState('');\r\n  const [colXtow, setColXtow] = useState('');\r\n  const [colY, setColY] = useState('');\r\n  const [full, setFull] = useState(false);\r\n  const [imageData, setImageData] = useState(null);\r\n  const [s, setS] = useState(false);\r\n  const [err, setErr] = useState(false);\r\n\r\n  const [selectedColorXoane, setSelectedColorXoane] = useState('Blue');\r\n  const [selectedColorXtow, setSelectedColorXtow] = useState('Blue');\r\n\r\n  const handleColorChangeXoane = (event) =\u003e {\r\n    setSelectedColorXoane(event.target.value);\r\n  };\r\n  const handleColorChangeXtow = (event) =\u003e {\r\n    setSelectedColorXtow(event.target.value);\r\n  };\r\n\r\n  const setCol = (name) =\u003e {\r\n    if (colXoane === '') {\r\n      setColXoane(name);\r\n    } else if (colXtow === '') {\r\n      setColXtow(name);\r\n      setFull(true);\r\n    } else if (colXoane !== '' \u0026\u0026 colXtow !== '') {\r\n      return;\r\n    }\r\n  };\r\n\r\n  const setY = (name) =\u003e {\r\n    setColY(name);\r\n  };\r\n\r\n  const json = {\r\n    columnX1: [colXoane, selectedColorXoane],\r\n    columnX2: [colXtow, selectedColorXtow],\r\n    Y: colY,\r\n  };\r\n\r\n  const createChart = async () =\u003e {\r\n    try {\r\n      const response = await fetch('#########', {\r\n        method: 'POST',\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n        },\r\n        body: JSON.stringify(json),\r\n      });\r\n\r\n      if (!response.ok) {\r\n        throw new Error('Eroare la cerere');\r\n      }\r\n      const blob = await response.blob();\r\n      const imageUrl = URL.createObjectURL(blob);\r\n      setImageData(imageUrl);\r\n      dispatch(excelAction.chart(true));\r\n      setS(true);\r\n    } catch (error) {\r\n      console.error(`An error occurred: ${error.message}`);\r\n      setErr('This combination does not make sens');\r\n    }\r\n    console.log(json);\r\n  };\r\n  const restore = () =\u003e {\r\n    setColXoane('');\r\n    setColXtow('');\r\n    setColY('');\r\n    setFull(false);\r\n    setImageData(null);\r\n    setS(false);\r\n    setSelectedColorXoane('Blue');\r\n    setSelectedColorXtow('Blue');\r\n    dispatch(excelAction.chart(false));\r\n    setErr(false);\r\n  };\r\n\r\n  const relode = (\r\n    \u003cbutton className={btn.btn} onClick={restore}\u003e\r\n      relode\r\n    \u003c/button\u003e\r\n  );\r\n\r\n  const colNames = arr.res.map((el) =\u003e (\r\n    \u003cChartBtn key={el} name={el} col={el} onClick={full ? setY : setCol} /\u003e\r\n  ));\r\n\r\n  const tablesChios = (\r\n    \u003c\u003e\r\n      \u003ctable className={style.tableConatiner}\u003e\r\n        \u003cthead\u003e\r\n          \u003ctr\u003e\r\n            \u003cth className={style.thead}\u003eAxis X\u003c/th\u003e\r\n            \u003cth className={style.thead}\u003eColor for X\u003c/th\u003e\r\n          \u003c/tr\u003e\r\n        \u003c/thead\u003e\r\n        \u003ctbody\u003e\r\n          \u003ctr\u003e\r\n            \u003ctd\r\n              className={style.tableContent}\r\n              style={{ color: selectedColorXoane, fontWeight: 'bold' }}\r\n            \u003e\r\n              {colXoane}\r\n            \u003c/td\u003e\r\n\r\n            \u003ctd className={style.tableContent}\u003e\r\n              \u003cselect\r\n                className={style.select}\r\n                value={selectedColorXoane}\r\n                onChange={handleColorChangeXoane}\r\n              \u003e\r\n                \u003coption className={style.option} value=\"Blue\"\u003e\r\n                  Blue\r\n                \u003c/option\u003e\r\n                \u003coption className={style.option} value=\"Red\"\u003e\r\n                  Red\r\n                \u003c/option\u003e\r\n                \u003coption className={style.option} value=\"Green\"\u003e\r\n                  Green\r\n                \u003c/option\u003e\r\n                \u003coption className={style.option} value=\"Yellow\"\u003e\r\n                  Yellow\r\n                \u003c/option\u003e\r\n              \u003c/select\u003e\r\n            \u003c/td\u003e\r\n          \u003c/tr\u003e\r\n          \u003ctr\u003e\r\n            \u003ctd\r\n              className={style.tableContent}\r\n              style={{ color: selectedColorXtow, fontWeight: 'bold' }}\r\n            \u003e\r\n              {colXtow}\r\n            \u003c/td\u003e\r\n\r\n            \u003ctd className={style.tableContent}\u003e\r\n              \u003cselect\r\n                value={selectedColorXtow}\r\n                onChange={handleColorChangeXtow}\r\n              \u003e\r\n                \u003coption value=\"Blue\"\u003eAlbastru\u003c/option\u003e\r\n                \u003coption value=\"Red\"\u003eRoșu\u003c/option\u003e\r\n                \u003coption value=\"Green\"\u003eVerde\u003c/option\u003e\r\n                \u003coption value=\"Yellow\"\u003eGalben\u003c/option\u003e\r\n              \u003c/select\u003e\r\n            \u003c/td\u003e\r\n          \u003c/tr\u003e\r\n        \u003c/tbody\u003e\r\n      \u003c/table\u003e\r\n      \u003ctable className={style.tableConatiner}\u003e\r\n        \u003cthead\u003e\r\n          \u003ctr\u003e\r\n            \u003cth className={style.thead}\u003eAxis Y\u003c/th\u003e\r\n          \u003c/tr\u003e\r\n        \u003c/thead\u003e\r\n        \u003ctbody\u003e\r\n          \u003ctr\u003e\r\n            \u003ctd className={style.tableContent} style={{ fontWeight: 'bold' }}\u003e\r\n              {colY}\r\n            \u003c/td\u003e\r\n          \u003c/tr\u003e\r\n        \u003c/tbody\u003e\r\n      \u003c/table\u003e\r\n    \u003c/\u003e\r\n  );\r\n\r\n  const img = (\r\n    \u003cdiv className={style.imgChart}\u003e\r\n      {imageData \u0026\u0026 (\r\n        \u003cimg className={style.img} src={imageData} alt=\"Descriere imagine\" /\u003e\r\n      )}\r\n    \u003c/div\u003e\r\n  );\r\n\r\n  const chart = (\r\n    \u003cdiv className={style.create}\u003e\r\n      \u003cdiv className={style.chartContainerBtn}\u003e\r\n        \u003csvg\r\n          className={style.svgBtn}\r\n          version=\"1.1\"\r\n          xmlns=\"http://www.w3.org/2000/svg\"\r\n          width=\"22\"\r\n          height=\"22\"\r\n          viewBox=\"0 0 32 32\"\r\n        \u003e\r\n          \u003cpath d=\"M29 0h-26c-1.65 0-3 1.35-3 3v26c0 1.65 1.35 3 3 3h26c1.65 0 3-1.35 3-3v-26c0-1.65-1.35-3-3-3zM14 24c0 1.1-0.9 2-2 2h-4c-1.1 0-2-0.9-2-2v-16c0-1.1 0.9-2 2-2h4c1.1 0 2 0.9 2 2v16zM26 18c0 1.1-0.9 2-2 2h-4c-1.1 0-2-0.9-2-2v-10c0-1.1 0.9-2 2-2h4c1.1 0 2 0.9 2 2v10z\"\u003e\u003c/path\u003e\r\n        \u003c/svg\u003e\r\n        \u003cbutton onClick={createChart} className={style.chartBtnStart}\u003e\r\n          Create\r\n        \u003c/button\u003e\r\n      \u003c/div\u003e\r\n      {err \u0026\u0026 (\r\n        \u003cdiv style={{ display: 'flex', flexDirection: 'column' }}\u003e\r\n          \u003cspan style={{ color: 'red' }}\u003e{err}\u003c/span\u003e\r\n          {relode}\r\n        \u003c/div\u003e\r\n      )}\r\n    \u003c/div\u003e\r\n  );\r\n\r\n  return (\r\n    \u003c\u003e\r\n      {!s \u0026\u0026 colNames}\r\n      {s \u0026\u0026 relode}\r\n      \u003cdiv className={s ? style.imgContainer : style.chartContainer}\u003e\r\n        {!s \u0026\u0026 tablesChios}\r\n        {s ? img : chart}\r\n      \u003c/div\u003e\r\n    \u003c/\u003e\r\n  );\r\n};\r\n\r\nexport default ChartSettings;\r\n```\r\n\r\n\r\n## Conclusion:\r\n\r\nThe front-end implementation demonstrates a well-structured and interactive approach for handling data visualization. It allows users to dynamically select columns for chart creation, customize colors, and submit requests to the backend. The component handles responses efficiently, displaying the generated chart as an image. With a focus on flexibility, it supports multiple combinations of input data and ensures proper error handling to provide a smooth user experience. The inclusion of a reset functionality allows for easy restoration of settings. This front-end approach integrates effectively with the backend, ensuring the process from data selection to chart generation is seamless, intuitive, and user-friendly.\r\n"},"nextProject":{"slug":"store","frontMatter":{"date":"2015-10-10","title":"Excel Store","lang":"Build with Python","description":"Backend with user creation and authentication, excel reading data and transfer in in JSON as response","image":"/images/project/05.jpg","color":"#BE0000","category":"Backend","projectInfo":[{"title":"Client","data":"World wide"},{"title":"Release date","data":"07-06-2024"},{"title":"Tehnology","data":"- Python\n- Rest API\n- Panda\n"},{"title":"Functions","data":"- Excel to JSON \n- User account\n- Custome API\n- Chart creation \n"}],"live":[{"link":"https://excelstore.gabrielchiorcea.tech/"}]},"content":"\r\n## Arhitecture.\r\n\r\nThis application serves as a backend capable of processing and reading data from Excel files. To utilize this backend and connect it to a frontend, a user account is required. The account is essential as it provides a unique API key for authentication and authorization.\r\n\r\nExcel files are read using Pandas, which converts the file content into a DataFrame. Once transformed into a DataFrame, the data is further converted into JSON format based on the specific functions or filters requested. This enables dynamic and customizable data extraction from the Excel file.\r\n\r\nThe Excel file itself is stored in the database as a binary large object (BLOB), ensuring secure and efficient storage\r\n\r\n\r\n\u003cdiv className=\"image columns-1 sm:columns-2 gap-8\"\u003e\r\n\r\n![Python 01.](/images/project/05-01.jpg)\r\n![Python 02.](/images/project/05-02.jpg)\r\n\u003c/div\u003e\r\n\r\n\r\n## Get and store the excel file\r\n\r\nThe Excel file is uploaded via the /excel endpoint of the API. At this endpoint, the file undergoes validation to ensure it is an Excel file, even if the frontend does not perform this check. Once validated, the file is renamed for consistency and security.\r\n\r\nThe renaming process involves appending a unique ID, derived from the user’s API key, to the file name. The resulting format is {ID}.xlsx. The renamed file is then securely stored in the database as a BLOB with its new identifier, ensuring traceability and efficient management.\r\n\r\n\r\n```python\r\n@app.route('/excel', methods=['POST'])\r\n@csrf.exempt\r\ndef upload_excel():\r\n    try:\r\n        # Check if a file is present in the request\r\n        if 'file' not in request.files:\r\n            return jsonify({'res': 'No file found in the request'}), 400\r\n        \r\n        file_in = request.files['file']\r\n        id = request.args.get('id')\r\n\r\n        # Validate the user ID parameter\r\n        if not id:\r\n            return jsonify({'res': 'Missing user ID'}), 400\r\n\r\n        # Check if the file name is empty\r\n        if file_in.filename == '':\r\n            return jsonify({'res': 'File name is empty'}), 400\r\n\r\n        # Validate the file extension (only .xlsx and .xls are allowed)\r\n        if not (file_in.filename.endswith('.xlsx') or file_in.filename.endswith('.xls')):\r\n            return jsonify({'res': 'Invalid file type, only Excel files are allowed (.xlsx, .xls)'}), 400\r\n\r\n        file_content = file_in.read()\r\n        \r\n        # Ensure the file is not empty\r\n        if not file_content:\r\n            return jsonify({'res': 'Uploaded file is empty'}), 400\r\n\r\n        # Generate a unique name for the file based on the user ID\r\n        file_name = f\"{id}.xlsx\"\r\n\r\n        # Create a new database record for the Excel file\r\n        new_excel_file = Excel(name=file_name, excel=file_content)\r\n\r\n        # Add the file to the database session and commit\r\n        db.session.add(new_excel_file)\r\n        db.session.commit()\r\n\r\n        return jsonify({'res': 'File uploaded successfully'}), 200\r\n\r\n    except Exception as e:\r\n        # Roll back the database transaction in case of an error\r\n        db.session.rollback()\r\n        print(f\"Error: {e}\")  # Log the error details to the console\r\n        return jsonify({'res': f'An error occurred while processing the file: {str(e)}'}), 500\r\n\r\n```\r\n\r\n## How the backend know what data to give you\r\n\r\nThe below API endpoint, accessible via /\u003cstring:para\u003e/\u003cstring:ident\u003e with a GET request, dynamically processes Excel files stored in a database. It retrieves the file based on an id query parameter, reads it into a Pandas DataFrame, and executes specific functions depending on the para value (e.g., counting null values, extracting data, summarizing content, filling missing values, or generating charts). The user's existence and identification (ident) are validated against the database, and if necessary, new identification records are created. By utilizing specialized classes (RespondGet and ResponseFill), the endpoint ensures modular and efficient data manipulation while maintaining robust error handling and database consistency.\r\n\r\n\r\n```python\r\n@app.route('/\u003cstring:para\u003e/\u003cstring:ident\u003e', methods=['GET'])\r\n@csrf.exempt\r\ndef get_with_ident(para, ident):\r\n    identificare = quote(ident)\r\n    id = request.args.get('id')\r\n    filename = str(id)+'.xlsx'\r\n    retrieved_excel_file = Excel.query.filter_by(name=filename).first()\r\n    excel_data = retrieved_excel_file.excel\r\n    excel_df = pd.read_excel(io.BytesIO(excel_data))\r\n    isntance_of_class = RespondGet(excel_df, id)\r\n    isntance_of_fill = ResponseFill(excel_df, id)\r\n    exist = User.query.filter_by(identification=identificare).first()\r\n    identt = Identification.query.filter_by(identification=identificare).first()\r\n\r\n    if(exist != None  and identt != None):\r\n            if para == \"CountNullValue\":\r\n                count = isntance_of_class.resp_get_null()\r\n                return count\r\n            elif para == \"ExtractValue\":\r\n                ex_val = isntance_of_class.resp_get_ex_val()\r\n                return ex_val\r\n            elif para == \"ExcelSummary\":\r\n                sumar = isntance_of_class.resp_get_ex_sumar()\r\n                return sumar\r\n            elif para == 'fillNANW0':\r\n                fill_na = isntance_of_fill.fill_na()\r\n                return fill_na\r\n            elif para == 'Chart':\r\n                chart = isntance_of_class.chart_columns()\r\n                return chart\r\n    elif(exist and identt == None):\r\n\r\n        time = datetime.now()\r\n        ident = Identification(timestamp=time, identification= identificare)\r\n        db.session.add(ident)\r\n        db.session.commit()\r\n        if para == \"CountNullValue\":\r\n            count = isntance_of_class.resp_get_null()\r\n            return count\r\n        elif para == \"ExtractValue\":\r\n            ex_val = isntance_of_class.resp_get_ex_val()\r\n            return ex_val\r\n        elif para == \"ExcelSummary\":\r\n            sumar = isntance_of_class.resp_get_ex_sumar()\r\n            return sumar\r\n        elif para == 'fillNANW0':\r\n            fill_na = isntance_of_fill.fill_na()\r\n            return fill_na\r\n        elif para == 'Chart':\r\n            chart = isntance_of_class.chart_columns()\r\n            return chart\r\n    else:\r\n        return jsonify({'val': exist}), 400\r\n```\r\n\r\n\r\n\r\n"}},"__N_SSG":true},"page":"/project/[slug]","query":{"slug":"power"},"buildId":"JQscGFTIUaoxojvdJBQvI","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>